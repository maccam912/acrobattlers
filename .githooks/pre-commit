#!/bin/sh
# Pre-commit hook for Deno project

# Store list of staged files
staged_files=$(git diff --staged --name-only)

echo "Running pre-commit checks..."

# Check for formatting errors
echo "Checking formatting..."
deno fmt --check || { echo "Formatting check failed. Run 'deno fmt' to format your code."; exit 1; }

# Lint code
echo "Linting code..."
deno lint || { echo "Linting failed. Please fix the linting issues and try again."; exit 1; }

# Type check code
echo "Type checking..."
deno check **/*.ts **/*.tsx || { echo "Type checking failed. Please fix the type errors and try again."; exit 1; }

# Run tests
echo "Running tests..."
deno test --allow-all || { echo "Tests failed. Please fix the failing tests and try again."; exit 1; }

echo "All pre-commit checks passed!"
exit 0
